<script src="../tinytest.js"></script>
<script>

  test({
    'It should not process elements appended to the array after the call to findIndex begins.': function () {
      var counter = 0;
      var array = [1, 2, 3];
      var result = findIndex(array, function (number, index) {
        if (index < 2) {
          array.push(4);
        }
        counter++;
        return number > 3;
      });
      eq(counter, 3);
      eq(result, -1);
    },
    'If an existing, unvisited element of the array is changed by callback, its value passed to the callback will be the value at the time that findIndex visits that element index.': function () {
      var array = [1, 2, 3];
      var result = findIndex(array, function (number, index) {
        if (index < 1) {
          array.splice(1, 1, 4);
        }
        return number > 3;
      });
      eq(result, 1);
    },
    'It should visit deleted index, and its value will be the value when findIndex visits that element index.': function () {
      var array = [1, 2, 3];
      var result = array.findIndex(function (element, index) {
        if (index < 1) {
          array.pop();
        }
        return element === undefined;
      });
      eq(result, 2);
    },
    'If the second argument is not a callback function, throw a TypeError.': function () {
      var isTypeError = false;
      try {
        findIndex([0], 'chujun');
      } catch (e) {
        isTypeError = e instanceof TypeError;
      }
      eq(isTypeError, true);
    },
    'It should work for an array-like object.': function () {
      var object = {
        length: 3,
        0: 0,
        1: 1,
        2: 2
      };
      var result = findIndex(object, function (num) {
        return num > 1;
      });
      eq(result, 2);
    }
  });
</script>
